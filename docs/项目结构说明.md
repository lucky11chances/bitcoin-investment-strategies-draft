# 项目结构说明

## 📁 整体结构

```
bitcoin-investment-strategies/
├── src/                             # 源代码文件夹（所有Python代码）
│   ├── strategies/                  # 策略实现模块
│   │   ├── __init__.py             # 策略模块初始化
│   │   ├── hodl.py                 # HODL策略（训练集）
│   │   ├── dca.py                  # DCA策略（训练集）
│   │   ├── dca_test.py             # DCA策略（测试集）
│   │   ├── quant_rf.py             # 量化策略（训练集）
│   │   └── quant_test.py           # 量化策略（测试集）
│   ├── __init__.py                 # 包初始化文件
│   ├── config.py                   # 全局配置模块
│   ├── metrics.py                  # 性能指标计算模块
│   ├── utils.py                    # 通用工具函数
│   └── main.py                     # 主程序（完整分析）
├── data/                            # 数据文件夹
│   ├── bitcoin_train_2010_2020 copy.csv    # 训练集数据
│   ├── bitcoin_test_2023_2024 copy.csv     # 测试集数据
│   └── bitcoin_valid_2021_2022 copy.csv    # 验证集数据
├── docs/                            # 文档文件夹
│   ├── README.md                    # 详细技术文档
│   ├── 策略对比报告.md               # 完整对比分析报告
│   ├── 量化策略技术总结.md           # 量化策略技术细节
│   ├── DCA与HODL策略假设分析.md     # 策略假设分析
│   ├── 项目重构说明.md               # 重构历史记录
│   └── 项目结构说明.md               # 本文档
├── .git/                            # Git版本控制
├── .gitignore                       # Git忽略配置
├── .venv/                           # Python虚拟环境
├── run.py                           # 项目入口点（推荐）
└── README.md                        # 项目简介
```

## 🎯 设计原则

### 1. **专业的src/结构**
- 所有Python源代码统一放在 `src/` 文件夹
- 符合Python项目最佳实践
- 清晰的代码与数据分离

### 2. **模块化设计**
- **config.py**: 单一配置源（Single Source of Truth）
  - 所有路径配置
  - 所有参数常量
  - 预训练权重
  
- **metrics.py**: 统一的指标计算
  - Sharpe Ratio
  - Sortino Ratio
  - Max Drawdown
  - Volatility
  - 避免代码重复

- **utils.py**: 通用工具函数
  - 数据加载
  - 格式化输出
  - 表格打印

- **strategies/**: 策略实现模块
  - 独立的策略文件
  - 统一使用config/metrics/utils
  - 易于扩展新策略

### 3. **包结构设计**
- 使用 `__init__.py` 建立正确的Python包结构
- 支持模块导入：`from src.strategies import hodl_compute`
- 版本管理：`src.__init__.py` 中定义版本号

### 4. **清晰的入口点**
- `run.py`: 项目根目录的主入口
  - 自动配置Python路径
  - 调用 `src.main` 模块
  - 可执行权限（chmod +x）

## 🚀 使用方式

### 方式一：使用run.py（推荐）
```bash
python run.py
```

### 方式二：直接运行main模块
```bash
python -m src.main
```

### 方式三：运行单个策略
```bash
# HODL策略
python -m src.strategies.hodl

# DCA策略（训练集）
python -m src.strategies.dca

# 量化策略（训练集）
python -m src.strategies.quant_rf
```

## 📊 数据流向

```
数据文件 (data/*.csv)
    ↓
config.py (路径配置)
    ↓
utils.py (数据加载)
    ↓
strategies/*.py (策略计算)
    ↓
metrics.py (性能评估)
    ↓
main.py (整合分析)
    ↓
run.py (用户入口)
```

## 🔧 技术优势

### 相比重构前的改进

**重构前**:
```
test/
├── hodl.py
├── dca.py
├── dca_test.py
├── quant_rf.py
├── quant_test.py
├── config.py
├── metrics.py
├── utils.py
├── main.py
├── test_comparison.py    # 冗余
├── data/
└── docs/
```
- ❌ 文件混乱，扁平结构
- ❌ 代码重复（每个文件都有相似的metrics计算）
- ❌ 参数硬编码分散
- ❌ 不符合专业Python项目规范

**重构后**:
```
test/
├── src/                  # 专业结构
│   ├── strategies/      # 模块化
│   ├── config.py       # 集中配置
│   ├── metrics.py      # 统一计算
│   └── ...
├── data/               # 数据分离
├── docs/              # 文档分离
└── run.py             # 清晰入口
```
- ✅ 专业的项目结构
- ✅ 模块化、可维护
- ✅ 代码复用率高
- ✅ 易于扩展和测试
- ✅ 符合Python最佳实践

### 代码复用成果

- 消除了 **150+ 行重复代码**
- 所有策略共享metrics计算逻辑
- 统一的配置管理（config.py）
- 通用的工具函数（utils.py）

## 📝 维护指南

### 添加新策略
1. 在 `src/strategies/` 创建新的.py文件
2. 导入并使用 `config`, `metrics`, `utils`
3. 在 `src/strategies/__init__.py` 中添加导出
4. 在 `src/main.py` 中集成（可选）

### 修改参数
- 直接编辑 `src/config.py`
- 所有策略自动使用新参数

### 添加新指标
- 在 `src/metrics.py` 添加计算函数
- 更新 `calculate_all_metrics()` 函数
- 所有策略自动获得新指标

## 🌟 为什么使用src/文件夹？

1. **行业标准**: Python专业项目的常见做法
2. **包管理**: 便于将项目打包成可安装的包
3. **导入清晰**: `from src.module import func` 更明确
4. **测试隔离**: 测试代码可以放在tests/文件夹，与源代码分离
5. **工具兼容**: 许多开发工具默认识别src/结构

## 📚 相关文档

- [README.md](../README.md) - 项目快速入门
- [docs/README.md](README.md) - 完整技术文档
- [docs/策略对比报告.md](策略对比报告.md) - 性能分析报告
- [docs/项目重构说明.md](项目重构说明.md) - 重构历史

---

**最后更新**: 2024-12-14  
**项目版本**: v1.0.0
